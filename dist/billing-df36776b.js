"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[964],{93016:(e,t,n)=>{n.r(t),n.d(t,{default:()=>be});var o=n(31635),r=n(69440),s=n(70355),a=n(49655),i=n(17986),l=n(6663);function d(e,t){return!(!e||!t)&&((0,r.isEqual)(c(e),c(t))&&function(e,t){if(e.stateOrProvince&&e.stateOrProvince===t.stateOrProvince)return!0;if(e.stateOrProvinceCode&&e.stateOrProvinceCode===t.stateOrProvinceCode)return!0;return e.stateOrProvince===t.stateOrProvince&&e.stateOrProvinceCode===t.stateOrProvinceCode}(e,t))}function c(e){return(0,r.omit)((0,o.__assign)((0,o.__assign)({},e),{customFields:(e.customFields||[]).filter((function(e){return!!e.fieldValue}))}),["id","shouldSaveAddress","stateOrProvince","stateOrProvinceCode","type","email","country"])}var u=n(45293),p=n(79001),m=n(84559);function g(e){return t=e.lineItems.physicalItems.filter((function(e){return!e.addedByPromotion&&!e.parentId})),(0,r.reduce)(t,(function(e,t){return e+t.quantity}),0);var t}var h=n(43586),f=n(38795),v=n(2030),_=n(68512),y=n(38989),A=n(68801),C=n(33318);var E=n(72769),b=n(69894),S=n(67113);const w=function(e){var t=e.address;return!(0,r.isEmpty)(t)?s.createElement("div",{className:"vcard checkout-address--static","data-test":"static-address"},s.createElement("p",{className:"address-entry"},function(e){var t=e.firstName,n=e.lastName,o=e.address1,r=e.address2,s=e.city,a=e.countryCode,i=[o,r,s,e.stateOrProvince,a,e.postalCode].filter(Boolean).join(", ");return t&&n&&i?"".concat(t," ").concat(n,", ").concat(i):""}(t))):null};var P=n(67464);const k=(0,_.A)((function(e){var t=e.selectedAddress,n=e.language,o=e.type,r=e.showSingleLineAddress,i=e.placeholderText,l=(0,s.useState)(!1),d=l[0],c=l[1];return s.createElement("a",{"aria-controls":"addressDropdown","aria-describedby":n.translate("address.enter_or_select_address_action"),"aria-expanded":d,className:"button dropdown-button dropdown-toggle--select","data-test":"address-select-button",href:"#",id:"addressToggle",onBlur:function(){return c(!1)},onClick:(0,E.A)((function(){return c(!d)}))},s.createElement((function(){return t?r?s.createElement(w,{address:t,type:o}):s.createElement(P.A,{address:t,type:o}):null!=i?i:s.createElement(a.A,{id:"address.enter_address_action"})}),null))}));var F=function(e){var t=e.addresses,n=e.onSelectAddress,o=e.onUseNewAddress,r=e.selectedAddress,i=e.type;return s.createElement("ul",{className:"dropdown-menu instrumentSelect-dropdownMenu",id:"addressDropdown"},s.createElement("li",{className:"dropdown-menu-item dropdown-menu-item--select"},s.createElement("a",{"data-test":"add-new-address",href:"#",onClick:(0,E.A)((function(){return o(r)}))},s.createElement(a.A,{id:"address.enter_address_action"}))),t.map((function(e){return s.createElement("li",{className:"dropdown-menu-item dropdown-menu-item--select","data-test":"address-select-option",key:e.id},s.createElement("a",{"data-test":"address-select-option-action",href:"#",onClick:(0,E.A)((function(){return n(e)}))},s.createElement(P.A,{address:e,type:i})))})))};const I=(0,s.memo)((function(e){var t=e.addresses,n=e.selectedAddress,o=e.type,r=e.showSingleLineAddress,a=e.onSelectAddress,i=e.onUseNewAddress,l=e.placeholderText,c=(0,y.A)().shouldShowPayPalFastlaneLabel;return s.createElement("div",{className:"form-field"},s.createElement("div",{className:"dropdown--select"},s.createElement(S.A,{dropdown:s.createElement(F,{addresses:t,onSelectAddress:function(e){d(n,e)||a(e)},onUseNewAddress:function(){i(n)},selectedAddress:n,type:o})},s.createElement(k,{addresses:t,placeholderText:l,selectedAddress:n,showSingleLineAddress:r,type:o}))),c&&s.createElement(b.A,null))}));var O=n(62562),N=n(44218),x=n(70946),L=n(60833),T=n(82418),V=n(37958),M={address1:"addressLine1",address2:"addressLine2",postalCode:"postCode",stateOrProvince:"province",stateOrProvinceCode:"provinceCode"};function B(e){return"".concat(M[e]||e)}function R(e){return"".concat(B(e),"Input")}const U=function(){function e(e){var t=e.address_components,n=e.name;this._name=n,this._address=t}return e.prototype.getState=function(){return this._get("administrative_area_level_1","short_name")},e.prototype.getStreet=function(){return this._name},e.prototype.getStreet2=function(){return"NZ"===this.getCountry()?this._get("sublocality","short_name"):this._get("subpremise","short_name")},e.prototype.getCity=function(){return this._get("postal_town","long_name")||this._get("locality","long_name")||this._get("neighborhood","short_name")},e.prototype.getCountry=function(){return this._get("country","short_name")},e.prototype.getPostCode=function(){return this._get("postal_code","short_name")},e.prototype._get=function(e,t){var n=this._address&&this._address.find((function(t){return-1!==t.types.indexOf(e)}));return n?n[t]:""},e}();const z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.getCity=function(){return this._get("sublocality_level_1","long_name")||this._get("locality","long_name")},t}(U);const K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.getState=function(){return""},t.prototype.getStreet2=function(){return this._get("locality","long_name")},t.prototype.getPostCode=function(){return""},t}(U);const D=function(){function e(){}return e.create=function(e){var t,n=null===(t=e.address_components)||void 0===t?void 0:t.find((function(e){return e.types.indexOf("country")>=0}));switch((null==n?void 0:n.short_name)||""){case"GB":return new K(e);case"CA":return new z(e);default:return new U(e)}},e}();var H=n(88376),W=n.n(H),j=n(28407),Z=n(22375),q=n(21037);const G=function(e){var t=e.children;return s.createElement("div",{className:"popover"},t)};function J(e,t){var n=["popoverList-item"];return e===t&&n.push("is-active"),n.join(" ")}const X=(0,s.memo)((function(e){var t=e.highlightedIndex,n=void 0===t?-1:t,r=e.testId,a=e.getItemProps,i=void 0===a?function(e){return e}:a,l=e.menuProps,d=void 0===l?{}:l,c=e.items;return c.length?s.createElement("ul",(0,o.__assign)({className:"popoverList","data-test":r},d),c.map((function(e,t){return s.createElement("li",(0,o.__assign)({className:J(n,t),"data-test":r&&"".concat(r,"-item")},i({key:e.id,index:t,item:e}),{key:t}),e.content)}))):null}));const Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stateReducer=function(e,n){var r=t.props.onChange;switch(n.type){case q.Ay.stateChangeTypes.blurInput:case q.Ay.stateChangeTypes.blurButton:case q.Ay.stateChangeTypes.mouseUp:case q.Ay.stateChangeTypes.touchEnd:return(0,o.__assign)((0,o.__assign)({},n),{inputValue:e.inputValue});case q.Ay.stateChangeTypes.changeInput:return n.inputValue!==e.inputValue&&r&&r(n.inputValue||"",e.isOpen),n;case q.Ay.stateChangeTypes.keyDownEnter:default:return n}},t.handleStateChange=function(e){var n=e.isOpen,o=e.inputValue,s=t.props.onToggleOpen,a=void 0===s?r.noop:s;void 0!==n&&a({isOpen:n,inputValue:o||""})},t}return(0,o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.inputProps,a=t.initialValue,i=t.initialHighlightedIndex,l=t.defaultHighlightedIndex,d=t.items,c=t.children,u=t.onSelect,p=t.listTestId;return s.createElement(q.Ay,{defaultHighlightedIndex:l,initialHighlightedIndex:i,initialInputValue:a,itemToString:this.itemToString,labelId:n&&n["aria-labelledby"]?n["aria-labelledby"]:null,onChange:u,onStateChange:this.handleStateChange,stateReducer:this.stateReducer},(function(t){var a=t.isOpen,i=t.getInputProps,l=t.getMenuProps,u=t.getItemProps,m=t.highlightedIndex,g=(0,o.__assign)((0,o.__assign)({},i()),n);return delete g.labelText,s.createElement("div",null,s.createElement("input",(0,o.__assign)({},g)),n&&(0,r.includes)(n.className,"floating")&&s.createElement(j.A,{htmlFor:n.id,id:n["aria-labelledby"],isFloatingLabelEnabled:!0},n.labelText),a&&!!d.length&&s.createElement(G,null,s.createElement(X,{getItemProps:u,highlightedIndex:(0,r.isNumber)(m)?m:-1,items:d.map((function(t){return e.toPopoverItem(t)})),menuProps:l(),testId:p}),c))}))},t.prototype.toPopoverItem=function(e){return(0,o.__assign)((0,o.__assign)({},e),{content:this.highlightItem(e)})},t.prototype.highlightItem=function(e){if(!e.highlightedSlices||!e.highlightedSlices.length)return e.label;var t=0,n=0;return e.highlightedSlices.reduce((function(o,r,a){var i=e.label,l=r.offset,d=r.length,c=l-t;return c&&(o.push(s.createElement(s.Fragment,{key:n},i.substr(t,c))),n+=1),t=l+d,o.push(s.createElement("strong",{key:n},i.substr(l,d))),n+=1,a===(e.highlightedSlices||[]).length-1&&(o.push(s.createElement(s.Fragment,{key:n},i.substr(t))),n+=1),o}),[])},t.prototype.itemToString=function(e){return e&&e.value||""},t}(s.PureComponent);var Y=n(80315);const $=function(){function e(){this._scriptLoader=(0,Y.getScriptLoader)()}return e.prototype.loadMapsSdk=function(e){var t=this;return this._googleAutoComplete||(this._googleAutoComplete=new Promise((function(n,o){var r="initAutoComplete",s=["language=en","key=".concat(e),"libraries=places","callback=".concat(r)].join("&");window[r]=function(){(function(e){var t=e;return Boolean(t.google&&t.google.maps&&t.google.maps.places)})(window)&&n(window.google.maps),o()},t._scriptLoader.loadScript("//maps.googleapis.com/maps/api/js?".concat(s)).catch((function(e){throw t._googleAutoComplete=void 0,e}))}))),this._googleAutoComplete},e}();var ee;const te=function(){function e(e,t){void 0===t&&(ee||(ee=new $),t=ee),this._apiKey=e,this._scriptLoader=t}return e.prototype.getAutocompleteService=function(){return this._autocompletePromise||(this._autocompletePromise=this._scriptLoader.loadMapsSdk(this._apiKey).then((function(e){if(!e.places.AutocompleteService)throw new Error("`AutocompleteService` is undefined");return new e.places.AutocompleteService}))),this._autocompletePromise},e.prototype.getPlacesServices=function(){var e=document.createElement("div");return this._placesPromise||(this._placesPromise=this._scriptLoader.loadMapsSdk(this._apiKey).then((function(t){if(!t.places.PlacesService)throw new Error("`PlacesService` is undefined");return new t.places.PlacesService(e)}))),this._placesPromise},e}();const ne=function(e){function t(t){var n=e.call(this,t)||this;return n.onSelect=function(e){var t=n.props,o=t.fields,s=t.onSelect,a=void 0===s?r.noop:s,i=t.nextElement;n.googleAutocompleteService.getPlacesServices().then((function(t){t.getDetails({placeId:e.id,fields:o||["address_components","name"]},(function(t){i&&i.focus(),a(t,e)}))}))},n.onChange=function(e){var t=n.props,o=t.isAutocompleteEnabled,s=t.onChange;if((void 0===s?r.noop:s)(e,!1),!o)return n.resetAutocomplete();n.setAutocomplete(e),n.setItems(e)},n.googleAutocompleteService=new te(t.apiKey),n.state={items:[],autoComplete:"off"},n}return(0,o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.initialValue,n=e.onToggleOpen,a=void 0===n?r.noop:n,i=e.inputProps,l=void 0===i?{}:i,d=this.state,c=d.autoComplete,u=d.items;return s.createElement(Q,{defaultHighlightedIndex:-1,initialHighlightedIndex:-1,initialValue:t,inputProps:(0,o.__assign)((0,o.__assign)({},l),{autoComplete:c}),items:u,listTestId:"address-autocomplete-suggestions",onChange:this.onChange,onSelect:this.onSelect,onToggleOpen:a},s.createElement("div",{className:"co-googleAutocomplete-footer"}))},t.prototype.setItems=function(e){var t=this;if(e){var n=this.props,o=n.componentRestrictions,r=n.types;this.googleAutocompleteService.getAutocompleteService().then((function(n){n.getPlacePredictions({input:e,types:r||["geocode"],componentRestrictions:o},(function(e){return t.setState({items:t.toAutocompleteItems(e)})}))}))}else this.setState({items:[]})},t.prototype.resetAutocomplete=function(){this.setState({items:[],autoComplete:"off"})},t.prototype.setAutocomplete=function(e){this.setState((0,o.__assign)((0,o.__assign)({},this.state),{autoComplete:e&&e.length?"nope":"off"}))},t.prototype.toAutocompleteItems=function(e){return(e||[]).map((function(e){return{label:e.description,value:e.structured_formatting.main_text,highlightedSlices:e.matched_substrings,id:e.place_id}}))},t}(s.PureComponent);const oe=(0,s.memo)((function(e){var t=e.field,n=t.default,o=t.name,r=t.maxLength,i=e.countryCode,l=e.supportedCountries,d=e.parentFieldName,c=e.nextElement,u=e.apiKey,p=e.onSelect,m=e.onChange,g=e.onToggleOpen,h=e.isFloatingLabelEnabled,f=d?"".concat(d,".").concat(o):o,v=(0,s.useMemo)((function(){return s.createElement(a.A,{id:"address.address_line_1_label"})}),[]),_=function(e){return"".concat(B(e),"Label")}(o),y=(0,s.useMemo)((function(){return{className:W()("form-input optimizedCheckout-form-input",{"floating-input":h}),id:R(o),"aria-labelledby":_,placeholder:h?" ":n,labelText:h?v:null,maxLength:r||void 0}}),[o,_,n,v,r]),A=(0,s.useCallback)((function(e){var t=e.field;return s.createElement(ne,{apiKey:u,componentRestrictions:i?{country:i}:void 0,initialValue:t.value,inputProps:y,isAutocompleteEnabled:!!i&&l.indexOf(i)>-1,nextElement:c,onChange:m,onSelect:p,onToggleOpen:g})}),[u,i,y,c,m,p,g,l]),C=h?null:s.createElement(j.A,{htmlFor:y.id,id:_,isFloatingLabelEnabled:h},v);return s.createElement("div",{className:W()("dynamic-form-field dynamic-form-field--addressLineAutocomplete",{"floating-form-field":h}),"data-test":"google-autocomplete-form-field"},s.createElement(Z.A,{input:A,isFloatingLabelEnabled:h,label:C,name:f}))}));var re={address1:"address.address_line_1_label",address2:"address.address_line_2_label",city:"address.city_label",company:"address.company_name_label",countryCode:"address.country_label",firstName:"address.first_name_label",lastName:"address.last_name_label",phone:"address.phone_number_label",postalCode:"address.postal_code_label",stateOrProvince:"address.state_label",stateOrProvinceCode:"address.state_label"},se={address1:"address-line1",address2:"address-line2",city:"address-level2",company:"organization",countryCode:"country",firstName:"given-name",lastName:"family-name",phone:"tel",postalCode:"postal-code",stateOrProvince:"address-level1",stateOrProvinceCode:"address-level1"},ae={countryCode:"address.select_country_action",stateOrProvince:"address.select_state_action",stateOrProvinceCode:"address.select_state_action"},ie="address1",le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerRef=(0,s.createRef)(),t.handleDynamicFormFieldChange=(0,N.memoize)((function(e){return function(n){t.syncNonFormikValue(e,n)}})),t.handleAutocompleteChange=function(e,n){n||t.syncNonFormikValue(ie,e)},t.handleAutocompleteSelect=function(e,n){var s=n.value,a=t.props,i=a.countries,l=a.setFieldValue,d=void 0===l?r.noop:l,c=a.onChange,u=void 0===c?r.noop:c,p=function(e,t){if(void 0===t&&(t=[]),!e||!e.address_components)return{};var n=D.create(e),r=n.getState(),s=n.getCountry(),a=t&&t.find((function(e){return s===e.code})),i=n.getStreet2();return(0,o.__assign)({address2:i,city:n.getCity(),countryCode:s,postalCode:n.getPostCode()},r?function(e,t){void 0===t&&(t=[]);var n=t.find((function(t){var n=t.code,o=t.name;return n===e||o===e}));return n?{stateOrProvince:n.name,stateOrProvinceCode:n.code}:{stateOrProvince:t.length?"":e,stateOrProvinceCode:""}}(r,a&&a.subdivisions):{})}(e,i);(0,r.forIn)(p,(function(e,t){d(t,e),u(t,e)})),s&&t.syncNonFormikValue(ie,s)},t.syncNonFormikValue=function(e,n){var o=t.props,s=o.formFields,a=o.setFieldValue,i=void 0===a?r.noop:a,l=o.onChange,d=void 0===l?r.noop:l,c=s.filter((function(e){return e.custom&&e.fieldType===x.A.date})).map((function(e){return e.name}));(e===ie||c.indexOf(e)>-1)&&i(e,n),d(e,n)},t}return(0,o.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.containerRef.current;e&&(this.nextElement=e.querySelector('[autocomplete="address-line2"]'))},t.prototype.render=function(){var e=this,t=this.props,n=t.formFields,o=t.fieldName,r=t.countriesWithAutocomplete,i=t.countryCode,l=t.googleMapsApiKey,d=t.onAutocompleteToggle,c=t.shouldShowSaveAddress,u=t.isFloatingLabelEnabled;return s.createElement(s.Fragment,null,s.createElement(L.A,null,s.createElement("div",{className:"checkout-address",ref:this.containerRef},n.map((function(t){var n=t.name,c=ae[n];return"address1"===n&&l&&r?s.createElement(oe,{apiKey:l,countryCode:i,field:t,isFloatingLabelEnabled:u,key:t.id,nextElement:e.nextElement||void 0,onChange:e.handleAutocompleteChange,onSelect:e.handleAutocompleteSelect,onToggleOpen:d,parentFieldName:o,supportedCountries:r}):s.createElement(T.A,{autocomplete:se[t.name],extraClass:"dynamic-form-field--".concat(B(n)),field:t,inputId:R(n),isFloatingLabelEnabled:u,key:"".concat(t.id,"-").concat(t.name),label:t.custom?t.label:s.createElement(a.A,{id:re[t.name]}),onChange:e.handleDynamicFormFieldChange(n),parentFieldName:t.custom?o?"".concat(o,".customFields"):"customFields":o,placeholder:e.getPlaceholderValue(t,c)})})))),c&&s.createElement(V.A,{labelContent:s.createElement(a.A,{id:"address.save_in_addressbook"}),name:o?"".concat(o,".shouldSaveAddress"):"shouldSaveAddress"}))},t.prototype.getPlaceholderValue=function(e,t){var n=this.props.language;return e.default&&"dropdown"!==e.fieldType?e.default:t&&n.translate(t)},t}(s.Component);const de=(0,_.A)(le);var ce=n(22011),ue=n(33515),pe=n(10685),me=n(54454);const ge=function(){var e=(0,s.useCallback)((function(e){return s.createElement(j.A,{hidden:!0,htmlFor:e},s.createElement(a.A,{id:"shipping.order_comment_label"}))}),[]),t=(0,s.useCallback)((function(e){var t=e.field;return s.createElement(me.A,(0,o.__assign)({},t,{autoComplete:"off",maxLength:2e3}))}),[]),n=(0,s.useMemo)((function(){return s.createElement(h.A,null,s.createElement(a.A,{id:"shipping.order_comment_label"}))}),[]);return s.createElement(L.A,{legend:n,testId:"checkout-shipping-comments"},s.createElement(Z.A,{id:"orderComment",input:t,label:e,name:"orderComment"}))};var he=n(46487),fe=n(4899),ve=n(73104);const _e=(0,_.A)((0,f.withFormik)({handleSubmit:function(e,t){(0,t.props.onSubmit)(e)},mapPropsToValues:function(e){var t=e.getFields,n=e.customerMessage,r=e.billingAddress;return(0,o.__assign)((0,o.__assign)({},(0,ce.A)(t(r&&r.countryCode),r)),{orderComment:n})},isInitialValid:function(e){var t=e.billingAddress,n=e.getFields,o=e.language;return!!t&&(0,ue.A)({language:o,formFields:n(t.countryCode)}).isValidSync(t)},validationSchema:function(e){var t=e.language,n=e.getFields;return"amazonpay"===e.methodId?(0,v.RZ)((function(e){return(0,pe.A)({translate:(0,ue.X)(t),formFields:n(e&&e.countryCode)})})):(0,v.RZ)((function(e){return(0,ue.A)({language:t,formFields:n(e&&e.countryCode)})}))},enableReinitialize:!0})((function(e){var t=e.googleMapsApiKey,n=e.billingAddress,l=e.countriesWithAutocomplete,c=e.customer,u=c.addresses,p=c.isGuest,m=e.getFields,g=e.countries,h=e.isUpdating,f=e.setFieldValue,v=e.shouldShowOrderComments,_=e.values,E=e.methodId,b=e.isFloatingLabelEnabled,S=e.updateAddress,w=e.onUnhandledError,P=(0,s.useState)(!1),k=P[0],F=P[1],N=(0,s.useRef)(null),x=(0,y.A)(),T=x.isPayPalFastlaneEnabled,V=x.paypalFastlaneAddresses,M="amazonpay"===E,B=m(_.countryCode),R=B.filter((function(e){return e.custom})),U=R.length>0,z=M&&U?R:B,K=T?V:u,D=(null==K?void 0:K.length)>0,H=n&&function(e,t,n){return!(!e||!(0,C.A)(e,n))&&(0,r.some)(t,(function(t){return d(t,e)}))}(n,K,m(n.countryCode)),W=function(e){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){var t;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:F(!0),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,S(e)];case 2:return n.sent(),[3,5];case 3:return(t=n.sent())instanceof Error&&w(t),[3,5];case 4:return F(!1),[7];case 5:return[2]}}))}))};return s.createElement(fe.A,{autoComplete:"on"},M&&n&&s.createElement("div",{className:"form-fieldset"},s.createElement(ve.A,{address:n})),s.createElement(L.A,{id:"checkoutBillingAddress",ref:N},D&&!M&&s.createElement(L.A,{id:"billingAddresses"},s.createElement(A.A,{isLoading:k},s.createElement(I,{addresses:K,onSelectAddress:W,onUseNewAddress:function(){W({})},selectedAddress:H?n:void 0,type:O.A.Billing}))),!H&&s.createElement(i.A,{isLoading:k},s.createElement(de,{countries:g,countriesWithAutocomplete:l,countryCode:_.countryCode,formFields:z,googleMapsApiKey:t,isFloatingLabelEnabled:b,setFieldValue:f,shouldShowSaveAddress:!p}))),v&&s.createElement(ge,null),s.createElement("div",{className:"form-actions"},s.createElement(he.Ay,{disabled:h||k,id:"checkout-billing-continue",isLoading:h||k,type:"submit",variant:he.Ak.Primary},s.createElement(a.A,{id:"common.continue_action"}))))})));var ye=n(57398),Ae=n(60045);function Ce(e){var t=function(e){return(e&&e.payments?e.payments:[]).find((function(e){return!(0,ye.A)(e)&&!(0,Ae.A)(e)&&!!e.providerId}))}(e);return t&&["amazonpay"].indexOf(t.providerId)>-1?t.providerId:void 0}var Ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSubmit=function(e){return(0,o.__awaiter)(t,void 0,void 0,(function(){var t,n,r,s,a,i,c,u,p,m,g=e.orderComment,h=(0,o.__rest)(e,["orderComment"]);return(0,o.__generator)(this,(function(e){switch(e.label){case 0:t=this.props,n=t.updateAddress,r=t.updateCheckout,s=t.customerMessage,a=t.billingAddress,i=t.navigateNextStep,c=t.onUnhandledError,u=[],(p=function(e){var t=e.customFields,n=(0,o.__rest)(e,["customFields"]),r=e.shouldSaveAddress;return(0,o.__assign)((0,o.__assign)({},n),{shouldSaveAddress:r,customFields:(0,l.A)(t)})}(h))&&!d(p,a)&&u.push(n(p)),s!==g&&u.push(r({customerMessage:g})),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(u)];case 2:return e.sent(),i(),[3,4];case 3:return(m=e.sent())instanceof Error&&c(m),[3,4];case 4:return[2]}}))}))},t}return(0,o.__extends)(t,e),t.prototype.componentDidMount=function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){var e,t,n,s,a,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:e=this.props,t=e.initialize,n=e.onReady,s=void 0===n?r.noop:n,a=e.onUnhandledError,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,t()];case 2:return o.sent(),s(),[3,4];case 3:return(i=o.sent())instanceof Error&&a(i),[3,4];case 4:return[2]}}))}))},t.prototype.render=function(){var e=this.props,t=e.updateAddress,n=e.isInitializing,r=(0,o.__rest)(e,["updateAddress","isInitializing"]);return s.createElement(i.A,{isLoading:n},s.createElement("div",{className:"checkout-form"},s.createElement("div",{className:"form-legend-container"},s.createElement(h.A,{testId:"billing-address-heading"},s.createElement(a.A,{id:"billing.billing_address_heading"}))),s.createElement(_e,(0,o.__assign)({},r,{onSubmit:this.handleSubmit,updateAddress:t}))))},t}(s.Component);const be=(0,u.A)((function(e){var t=e.checkoutService,n=e.checkoutState,o=n.data,r=o.getCheckout,s=o.getConfig,a=o.getCart,i=o.getCustomer,l=o.getBillingAddress,d=o.getBillingAddressFields,c=o.getBillingCountries,u=n.statuses,h=u.isLoadingBillingCountries,f=u.isUpdatingBillingAddress,v=u.isUpdatingCheckout,_=s(),y=i(),A=r(),C=a();if(!(_&&y&&A&&C))return null;var E=_.checkoutSettings,b=E.enableOrderComments,S=E.googleMapsApiKey;return{billingAddress:l(),countries:c()||p.M,countriesWithAutocomplete:["US","CA","AU","NZ","GB"],customer:y,customerMessage:A.customerMessage,getFields:d,googleMapsApiKey:S,initialize:t.loadBillingAddressFields,isInitializing:h(),isUpdating:f()||v(),methodId:Ce(A),shouldShowOrderComments:b&&g(C)<1,updateAddress:t.updateBillingAddress,updateCheckout:t.updateCheckout,isFloatingLabelEnabled:(0,m.A)(_.checkoutSettings)}}))(Ee)},67113:(e,t,n)=>{n.d(t,{A:()=>i});var o=n(31635),r=n(70355),s=n(6289),a=n(91605);const i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={shouldShow:!1},t.handleClick=function(e){t.state.shouldShow?t.handleClose(e.nativeEvent):t.handleOpen(e.nativeEvent)},t.handleOpen=function(){t.state.shouldShow||t.setState({shouldShow:!0},(function(){var e;null===(e=t.getRootElement())||void 0===e||e.addEventListener("click",t.handleClose)}))},t.handleClose=function(){t.state.shouldShow&&t.setState({shouldShow:!1},(function(){var e;null===(e=t.getRootElement())||void 0===e||e.removeEventListener("click",t.handleClose)}))},t}return(0,o.__extends)(t,e),t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.handleClose)},t.prototype.render=function(){var e=this,t=this.props,n=t.children,a=t.placement,i=t.dropdown,l=this.state.shouldShow;return r.createElement(s.mS,null,r.createElement(s.Or,null,(function(t){var o=t.ref;return r.createElement("div",{className:"dropdownTrigger",onClick:e.handleClick,ref:o},n)})),r.createElement(s.ND,{modifiers:{hide:{enabled:!1},flip:{enabled:!1},preventOverflow:{enabled:!1}},placement:a},(function(e){var t=e.ref,n=e.style;return l?r.createElement("div",{className:"dropdownMenu",ref:t,style:(0,o.__assign)((0,o.__assign)({},n),{width:"100%",zIndex:1})},i):null})))},t.prototype.getRootElement=function(){return document.getElementById(a.B)||document.getElementById(a.S)},t.defaultProps={placement:"bottom-start"},t}(r.Component)},91605:(e,t,n)=>{n.d(t,{B:()=>o,S:()=>r});var o="checkout-app",r="micro-app-ng-checkout"}}]);
//# sourceMappingURL=billing-df36776b.js.map